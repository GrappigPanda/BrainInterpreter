needs to support nested loops.
